
<h1 id="header">Add new Worker</h1>
<mat-stepper [linear]="true" #stepper>

    <mat-step [stepControl]="addEmployeeForm">
        <form [formGroup]="addEmployeeForm">
            <ng-template matStepLabel>Fill out employee details</ng-template>
            <div class="names">
                <mat-form-field>
                    <mat-label>First name</mat-label>
                    <input matInput placeholder="First name" formControlName="firstName">
                </mat-form-field>
                <mat-form-field>
                    <mat-label>Last name</mat-label>
                    <input matInput placeholder="Last name" formControlName="lastName">
                </mat-form-field>
            </div>

            <div class="privateDetails">
                <mat-form-field>
                    <mat-label>Identity number</mat-label>
                    <input matInput placeholder="Identity number" formControlName="identityNum">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Birth date</mat-label>
                    <input matInput [matDatepicker]="birthPicker" formControlName="birthDate">
                    <mat-hint>MM/DD/YYYY</mat-hint>
                    <mat-datepicker-toggle matIconSuffix [for]="birthPicker"></mat-datepicker-toggle>
                    <mat-datepicker #birthPicker></mat-datepicker>
                </mat-form-field>
            </div>

            <mat-button-toggle-group aria-label="Gender" formControlName="gender">
                <mat-button-toggle value=1>Male</mat-button-toggle>
                <mat-button-toggle value=2>Female</mat-button-toggle>
            </mat-button-toggle-group><br>

            <mat-form-field>
                <mat-label>Job-Start date</mat-label>
                <input matInput [matDatepicker]="jobStartDatePicker" formControlName="startDate">
                <mat-hint>MM/DD/YYYY</mat-hint>
                <mat-datepicker-toggle matIconSuffix [for]="jobStartDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #jobStartDatePicker></mat-datepicker>
            </mat-form-field>

            <div>
                <button mat-button matStepperNext>Next</button>
            </div>
        </form>
    </mat-step>

    <mat-step errorMessage="Address is required.">
        <ng-template matStepLabel>Add jobs to employee</ng-template>

        @for (form of addEmployeeForm.get('empJobs')['controls']; track form) {
        <ng-container [formGroup]="form">
            <mat-form-field>
                <mat-label>job</mat-label>
                <mat-select formControlName="job" required>
                    @for(job of jobs; track job){
                    <mat-option [value]="job.id" [disabled]="selectedJobs.includes(job.id)">{{job.name}}</mat-option>
                    }
                </mat-select>
            </mat-form-field>

            <mat-form-field>
                <mat-label>is management</mat-label>
                <mat-select formControlName="isManagement">
                    <mat-option [value]="false">ללא ניהול</mat-option>
                    <mat-option [value]="true">ניהולי</mat-option>
                </mat-select>
            </mat-form-field>
           
            <mat-form-field>
                <mat-label>Entry date</mat-label>
                <input matInput [matDatepicker]="entryDatePicker"  formControlName="entryDate"
                  [matDatepickerFilter]="filterStartDate">
                  <mat-hint>MM/DD/YYYY</mat-hint>
                <mat-datepicker-toggle matSuffix [for]="entryDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #entryDatePicker></mat-datepicker>
              </mat-form-field>

            <button (click)="removeJobForm($index)" mat-icon-button matTooltip="Remove Job">
                <mat-icon>delete</mat-icon>
            </button>
        </ng-container>
        }
        <div>
            <button class="addButton" (click)="addJobForm()" mat-fab extended color="primary">
                <mat-icon>add</mat-icon>Add Job</button>            
        </div>

        <div>
            <button mat-button matStepperPrevious>Back</button>
            <button mat-button matStepperNext>Next</button>
        </div>

    </mat-step>

    <mat-step>
        <ng-template matStepLabel>Done</ng-template>
        <p>You are now done.</p>
        <div>
            <button mat-button matStepperPrevious>Back</button>
            <button mat-button (click)="stepper.reset()">Reset</button>
        </div>
        <button (click)="submitForm()" type="submit" mat-raised-button color="primary">Save</button>

    </mat-step>
</mat-stepper>